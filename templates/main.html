<!DOCTYPE html>
<html dir="ltr">
<head>
    <meta charset="UTF-8">
    <title>CPU</title>
    <script src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.0/dojo/dojo.js" type="text/javascript"></script>
    <script type="text/javascript">
        var refresh = function(){
            var get = new dojo.xhrGet({
                        handleAs: "json",
                        url: "./last/"
                    }).then(function(result) {
                dojo.byId('date').innerHTML= result[0].date.split('.')[0].replace('T',' ');
                dojo.forEach(result, function(item) {
                    var e = dojo.byId(item.model);
                    for (var d in item) {
                        dojo.query('.' + d).forEach(function(i) { i.innerHTML = item[d]; });
                    }
                });
            });
            setTimeout(refresh,10000);
        };
        dojo.addOnLoad(refresh);
    </script>
    <style>
        #date {margin-left: 20px; border: black 1px dashed;}

        h2 {font-size: 18px; margin: 2px; padding: 2px;}

        table {
            border-collapse: collapse;
            border: black 1px solid;
        }

        table td, th {
            border: black 1px solid;
            /*width: 70px;*/
            text-align: center;
        }
        .hmdt { color: blue; }
        .temp { color: red; }
    </style>
</head>
<body>
<a href='chart/'>График</a><span id='date'></span>
<h2>Релсиб</h2>
<table id='dvt'>
    <tr>
        <th>Позиция</th>
        <th class='hmdt'>Влаж</th>
        <th class='temp'>Темп</th>
    </tr>
    {% for a in dvt %}
        <tr id='{{ a }}'>
            <th>{{ a.position }}</th>
            <td class='hmdt'></td>
            <td class='temp'></td>
        </tr>
    {% endfor %}
</table>
<h2>Термодат</h2>
<table id='termodat'>
    {% for a in termodat %}
        <thead>
        <tr>
            <th>Позиция</th>
            {% for f in a.fields %}
                {% if f.name == 't7' %}
                    </tr></thead><tfoot><tr><th>Позиция</th>
                {% endif %}
                {% if f.verbose_name %}
                    <th>{{ f.verbose_name }}</th>
                {% endif %}

            {% endfor %}
        </tr>
        </tfoot>
        <thead>
        <tr id='{{ a.model }}'>
            <th>Сушка</th>
            {% for f in a.fields %}
                {% if f.name == 't7' %}
                    </tr></thead><tfoot><tr><th>Обжиг</th>
                {% endif %}
                {% if f.verbose_name %}
                    <td class='{{ f.name }}'></td>
                {% endif %}
            {% endfor %}
        </tr>
        </tfoot>
    {% endfor %}
</table>
</body>
</html>
